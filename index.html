<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Simple Platform Settlement</title>
<style>
  body{font-family:Arial,Helvetica,sans-serif;background:#f3f6fb;padding:18px}
  .box{max-width:520px;margin:0 auto;background:#fff;padding:16px;border-radius:10px;box-shadow:0 6px 20px rgba(10,20,40,0.08)}
  h2{margin:0 0 8px;font-size:18px}
  .switch{display:flex;gap:8px;margin-bottom:12px}
  button{flex:1;padding:10px;border-radius:8px;border:0;cursor:pointer;font-weight:600}
  .active{background:#0b63d5;color:#fff} .idle{background:#eef3ff;color:#0b63d5}
  label{display:block;margin-top:8px;font-size:13px;color:#333}
  input[type=number]{width:100%;padding:10px;border-radius:8px;border:1px solid #e6eef8;margin-top:6px}
  .result{margin-top:12px;padding:12px;background:#f8fbff;border-radius:8px;border:1px solid #e6f0ff}
  .row{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px dashed #eef6ff}
  .row:last-child{border-bottom:0}
  .muted{color:#556; font-size:13px}
</style>
</head>
<body>
  <div class="box">
    <h2>Simple Platform Settlement</h2>

    <div class="switch">
      <button id="btnAmazon" class="active">Amazon</button>
      <button id="btnDukaan" class="idle">MyDukaan</button>
    </div>

    <label>Price on platform (₹) — enter amount shown to customer</label>
    <input id="price" type="number" step="0.01" value="8999"/>

    <div style="display:flex;gap:8px;margin-top:8px">
      <button id="calc" style="flex:1;background:#06b; color:#fff;border-radius:8px;padding:10px">Calculate</button>
      <button id="reset" style="flex:1;background:#eef3ff;color:#064; border-radius:8px;padding:10px">Reset</button>
    </div>

    <div id="out" class="result" aria-live="polite">
      <div class="row"><div class="muted">Platform</div><div id="plat" class="muted">Amazon</div></div>
      <div class="row"><div class="muted">Price on platform</div><div id="outPrice" class="muted">—</div></div>
      <div class="row"><div class="muted">Settlement (with GST)</div><div id="settleWith" class="muted">—</div></div>
      <div class="row"><div class="muted">Settlement (after removed GST)</div><div id="settleNoGST" class="muted">—</div></div>
      <div style="height:8px"></div>
      <div class="muted" id="explain" style="font-size:13px"></div>
    </div>
  </div>

<script>
  // Defaults
  const amazon = { commPct:0.15, courier:150, gstPct:0.18 };
  const mydukaan = { commPct:0.0399, pgPct:0.025, courierIncluded:100, gstPct:0.18 };

  let platform = 'amazon';
  const btnA = document.getElementById('btnAmazon');
  const btnD = document.getElementById('btnDukaan');
  const priceEl = document.getElementById('price');
  const platOut = document.getElementById('plat');
  const outPrice = document.getElementById('outPrice');
  const settleWith = document.getElementById('settleWith');
  const settleNoGST = document.getElementById('settleNoGST');
  const explain = document.getElementById('explain');

  function setActive(p){
    platform = p;
    if(p==='amazon'){ btnA.className='active'; btnD.className='idle'; platOut.textContent='Amazon'; }
    else { btnA.className='idle'; btnD.className='active'; platOut.textContent='MyDukaan'; }
  }
  btnA.onclick = ()=> setActive('amazon');
  btnD.onclick = ()=> setActive('mydukaan');

  function money(x){ return '₹'+Number(x).toLocaleString('en-IN',{minimumFractionDigits:2, maximumFractionDigits:2}); }

  function calc(){
    const P = Number(priceEl.value) || 0;
    outPrice.textContent = money(P);

    if(platform === 'amazon'){
      const gst = amazon.gstPct;
      // SP includes GST
      const base = P / (1+gst);
      const gstOnSP = P - base;
      const commission = P * amazon.commPct;
      const gstOnCommission = commission * gst;
      const totalDeduct = commission + gstOnCommission + amazon.courier;
      const settlement_with_gst = P - totalDeduct;
      const settlement_after_removed_gst = settlement_with_gst - gstOnSP;

      settleWith.textContent = money(settlement_with_gst);
      settleNoGST.textContent = money(settlement_after_removed_gst);

      explain.textContent = `Break: base ₹${money(base)} + GST ₹${money(gstOnSP)}. Commission ₹${money(commission)} + GST on commission ₹${money(gstOnCommission)} + courier ₹${money(amazon.courier)}.`;
    } else {
      // MyDukaan
      const gst = mydukaan.gstPct;
      const base = P / (1+gst);
      const gstOnSP = P - base;
      const commission = P * mydukaan.commPct;
      const pgfee = P * mydukaan.pgPct;
      const gstOnFees = (commission + pgfee) * gst;
      // courier included in price — not separately deducted (you said included)
      const totalDeduct = commission + pgfee + gstOnFees;
      const settlement_with_gst = P - totalDeduct;
      const settlement_after_removed_gst = settlement_with_gst - gstOnSP;

      settleWith.textContent = money(settlement_with_gst);
      settleNoGST.textContent = money(settlement_after_removed_gst);

      explain.textContent = `Break: base ₹${money(base)} + GST ₹${money(gstOnSP)}. Commission ₹${money(commission)} + PG ₹${money(pgfee)} + GST on fees ₹${money(gstOnFees)}. (Courier ₹${money(mydukaan.courierIncluded)} included in price)`;
    }
  }

  document.getElementById('calc').addEventListener('click', calc);
  document.getElementById('reset').addEventListener('click', ()=>{
    priceEl.value = (platform==='amazon')?8999:1000;
    outPrice.textContent = '—';
    settleWith.textContent = '—';
    settleNoGST.textContent = '—';
    explain.textContent = '';
  });

  // initial
  setActive('amazon');
  calc();
</script>
</body>
</html>
